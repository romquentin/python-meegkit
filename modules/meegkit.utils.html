<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>meegkit.utils &#8212; MEEGkit  documentation</title>
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/gallery.css" />
    <link rel="stylesheet" type="text/css" href="../_static/gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../_static/gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/gallery-rendered-html.css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="MEEGkit examples" href="../auto_examples/index.html" />
    <link rel="prev" title="meegkit.tspca" href="meegkit.tspca.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js "></script>
<script type="text/javascript" src="../_static/js/jquery-fix.js "></script>
<script type="text/javascript" src="../_static/bootstrap-3.3.7/js/bootstrap.min.js "></script>
<script type="text/javascript" src="../_static/bootstrap-sphinx.js "></script>

  </head><body>

  <div id="navbar" class="navbar navbar-inverse navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html">
          MEEGkit</a>
        <span class="navbar-text navbar-version pull-left"><b>0.1.1</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../auto_examples/index.html">Examples</a></li>
                <li><a href="https://github.com/nbara/python-meegkit">GitHub</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">MEEGkit documentation <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="meegkit.asr.html">meegkit.asr</a></li>
<li class="toctree-l1"><a class="reference internal" href="meegkit.cca.html">meegkit.cca</a></li>
<li class="toctree-l1"><a class="reference internal" href="meegkit.dss.html">meegkit.dss</a></li>
<li class="toctree-l1"><a class="reference internal" href="meegkit.detrend.html">meegkit.detrend</a></li>
<li class="toctree-l1"><a class="reference internal" href="meegkit.ress.html">meegkit.ress</a></li>
<li class="toctree-l1"><a class="reference internal" href="meegkit.sns.html">meegkit.sns</a></li>
<li class="toctree-l1"><a class="reference internal" href="meegkit.star.html">meegkit.star</a></li>
<li class="toctree-l1"><a class="reference internal" href="meegkit.tspca.html">meegkit.tspca</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">meegkit.utils</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-meegkit.utils.auditory">Auditory</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-meegkit.utils.covariances">Covariances</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-meegkit.utils.denoise">Denoising</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-meegkit.utils.matrix">Matrix manipulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-meegkit.utils.sig">Signal</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-meegkit.utils.stats">Statistics</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../auto_examples/index.html">MEEGkit examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../auto_examples/example_dering.html">Ringing artifact reduction example</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_examples/example_dering.html#detrending">Detrending</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_examples/example_star.html">Sparse time artifact removal on simulated data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_examples/example_dss.html">DSS example</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_examples/example_asr.html">ASR example</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_examples/example_detrend.html">Robust detrending examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_examples/example_detrend.html#regression">Regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_examples/example_detrend.html#detrending">Detrending</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_examples/example_star_dss.html">Example demonstrating STAR + DSS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_examples/example_mcca.html">Example multiway canonical correlation analysis (mCCA)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../auto_examples/example_ress.html">Rhythmic Entrainment Source Separation (RESS) example</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">meegkit.utils</a><ul>
<li><a class="reference internal" href="#module-meegkit.utils.auditory">Auditory</a></li>
<li><a class="reference internal" href="#module-meegkit.utils.covariances">Covariances</a></li>
<li><a class="reference internal" href="#module-meegkit.utils.denoise">Denoising</a></li>
<li><a class="reference internal" href="#module-meegkit.utils.matrix">Matrix manipulation</a></li>
<li><a class="reference internal" href="#module-meegkit.utils.sig">Signal</a></li>
<li><a class="reference internal" href="#module-meegkit.utils.stats">Statistics</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
            
            
            
              <li class="hidden-sm">
<div id="sourcelink">
  <a href="../_sources/modules/meegkit.utils.rst.txt"
     rel="nofollow">Source</a>
</div></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <div class="section" id="module-meegkit.utils">
<span id="meegkit-utils"></span><h1>meegkit.utils<a class="headerlink" href="#module-meegkit.utils" title="Permalink to this headline">Â¶</a></h1>
<p>Utility functions.</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#module-meegkit.utils.auditory" title="meegkit.utils.auditory"><code class="xref py py-obj docutils literal notranslate"><span class="pre">auditory</span></code></a></p></td>
<td><p>Tools for working with auditory signals.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#module-meegkit.utils.covariances" title="meegkit.utils.covariances"><code class="xref py py-obj docutils literal notranslate"><span class="pre">covariances</span></code></a></p></td>
<td><p>Covariance calculation.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#module-meegkit.utils.denoise" title="meegkit.utils.denoise"><code class="xref py py-obj docutils literal notranslate"><span class="pre">denoise</span></code></a></p></td>
<td><p>Denoising utilities.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#module-meegkit.utils.matrix" title="meegkit.utils.matrix"><code class="xref py py-obj docutils literal notranslate"><span class="pre">matrix</span></code></a></p></td>
<td><p>Matrix operation utility functions.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#module-meegkit.utils.sig" title="meegkit.utils.sig"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sig</span></code></a></p></td>
<td><p>Audio and signal processing tools.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#module-meegkit.utils.stats" title="meegkit.utils.stats"><code class="xref py py-obj docutils literal notranslate"><span class="pre">stats</span></code></a></p></td>
<td><p>Statistics utilities.</p></td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line"><br /></div>
</div>
<hr class="docutils" />
<div class="section" id="module-meegkit.utils.auditory">
<span id="auditory"></span><h2>Auditory<a class="headerlink" href="#module-meegkit.utils.auditory" title="Permalink to this headline">Â¶</a></h2>
<p>Tools for working with auditory signals.</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
</tbody>
</table>
<dl class="py class">
<dt id="meegkit.utils.auditory.AuditoryFilterbank">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">meegkit.utils.auditory.</span></code><code class="sig-name descname"><span class="pre">AuditoryFilterbank</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sfreq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.019</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">9.26449</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_bw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">24.7</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.auditory.AuditoryFilterbank" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#meegkit.utils.auditory.GammatoneFilterbank" title="meegkit.utils.auditory.GammatoneFilterbank"><code class="xref py py-class docutils literal notranslate"><span class="pre">meegkit.utils.auditory.GammatoneFilterbank</span></code></a></p>
<p>Special case of Gammatone filterbank with preset center frequencies.</p>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">filter</span></code>(X)</p></td>
<td><p>Filter X along its last dimension.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="meegkit.utils.auditory.AuditoryFilterbank.__init__">
<code class="sig-name descname"><span class="pre">__init__</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sfreq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.019</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">9.26449</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_bw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">24.7</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.auditory.AuditoryFilterbank.__init__" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Initialize self.  See help(type(self)) for accurate signature.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="meegkit.utils.auditory.GammatoneFilterbank">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">meegkit.utils.auditory.</span></code><code class="sig-name descname"><span class="pre">GammatoneFilterbank</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sfreq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.019</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">9.26449</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_bw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">24.7</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.auditory.GammatoneFilterbank" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Gammatone Filterbank.</p>
<p>This class computes the filter coefficients for a bank of Gammatone
filters. These filters were defined by Patterson and Holdworth for
simulating the cochlea, and originally implemented in <a class="reference internal" href="#re1f0d87dfb88-1" id="id1">[1]</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sfreq</strong> (<em>float</em>) â Sampling frequency of the signals to filter.</p></li>
<li><p><strong>cf</strong> (<em>array_like</em>) â Center frequencies of the filterbank.</p></li>
<li><p><strong>b</strong> (<em>float</em>) â beta of the gammatone filters (default=1.019).</p></li>
<li><p><strong>order</strong> (<em>int</em>) â Order (default=1).</p></li>
<li><p><strong>q</strong> (<em>float</em>) â Q-value of the ERB (default=9.26449).</p></li>
<li><p><strong>min_bw</strong> (<em>float</em>) â Minimum bandwidth of an ERB.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The python was adapted from Alexandre Chabot-Leclercâs pambox, and Jason
Heerisâ gammatone toolbox:
<a class="reference external" href="https://github.com/achabotl/pambox">https://github.com/achabotl/pambox</a>
<a class="reference external" href="https://github.com/detly/gammatone">https://github.com/detly/gammatone</a></p>
<p class="rubric">References</p>
<dl class="citation">
<dt class="label" id="re1f0d87dfb88-1"><span class="brackets"><a class="fn-backref" href="#id1">1</a></span></dt>
<dd><p>Slaney, M. (1993). An efficient implementation of the
Patterson-Holdsworth auditory filter bank. Apple Computer, Perception
Group, Tech. Rep, 35(8).</p>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#meegkit.utils.auditory.GammatoneFilterbank.filter" title="meegkit.utils.auditory.GammatoneFilterbank.filter"><code class="xref py py-obj docutils literal notranslate"><span class="pre">filter</span></code></a>(X)</p></td>
<td><p>Filter X along its last dimension.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="meegkit.utils.auditory.GammatoneFilterbank.__init__">
<code class="sig-name descname"><span class="pre">__init__</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sfreq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.019</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">9.26449</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_bw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">24.7</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.auditory.GammatoneFilterbank.__init__" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Initialize self.  See help(type(self)) for accurate signature.</p>
</dd></dl>

<dl class="py method">
<dt id="meegkit.utils.auditory.GammatoneFilterbank.filter">
<code class="sig-name descname"><span class="pre">filter</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.auditory.GammatoneFilterbank.filter" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Filter X along its last dimension.</p>
<p>Process an input waveform with a gammatone filter bank. This function
takes a single sound vector, and returns an array of filter outputs,
one channel per row.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>X</strong> (<em>ndarray</em><em>, </em><em>shape=</em><em>(</em><em>n_chans</em><em>, </em><em>n_times</em><em>)</em>) â Signal to filter.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Filtered signals with shape <code class="docutils literal notranslate"><span class="pre">(M,</span> <span class="pre">N)</span></code>, where <code class="docutils literal notranslate"><span class="pre">M</span></code> is the number
of channels, and <code class="docutils literal notranslate"><span class="pre">N</span></code> is the input signalâs number of samples.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="meegkit.utils.auditory.erb2hz">
<code class="sig-prename descclassname"><span class="pre">meegkit.utils.auditory.</span></code><code class="sig-name descname"><span class="pre">erb2hz</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">erb</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.auditory.erb2hz" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Convert ERB-rate values to the corresponding frequencies in Hz.</p>
</dd></dl>

<dl class="py function">
<dt id="meegkit.utils.auditory.erb_bandwidth">
<code class="sig-prename descclassname"><span class="pre">meegkit.utils.auditory.</span></code><code class="sig-name descname"><span class="pre">erb_bandwidth</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fc</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.auditory.erb_bandwidth" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Bandwidth of an Equivalent Rectangular Bandwidth (ERB).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>fc</strong> (<em>ndarray</em>) â Center frequency, or center frequencies, of the filter.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Equivalent rectangular bandwidth of the filter(s).</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray or float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="meegkit.utils.auditory.erbspace">
<code class="sig-prename descclassname"><span class="pre">meegkit.utils.auditory.</span></code><code class="sig-name descname"><span class="pre">erbspace</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flow</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fhigh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.auditory.erbspace" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Generate n equidistantly spaced points on ERB scale.</p>
</dd></dl>

<dl class="py function">
<dt id="meegkit.utils.auditory.hz2erb">
<code class="sig-prename descclassname"><span class="pre">meegkit.utils.auditory.</span></code><code class="sig-name descname"><span class="pre">hz2erb</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.auditory.hz2erb" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Convert frequencies to the corresponding ERB-rates.</p>
<p class="rubric">Notes</p>
<p>There is a round-off error in the Glasberg &amp; Moore paper, as 1000 / (24.7 *
4.37) * log(10) = 21.332 and not 21.4 as is stated.</p>
</dd></dl>

<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="module-meegkit.utils.covariances">
<span id="covariances"></span><h2>Covariances<a class="headerlink" href="#module-meegkit.utils.covariances" title="Permalink to this headline">Â¶</a></h2>
<p>Covariance calculation.</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
</tbody>
</table>
<dl class="py function">
<dt id="meegkit.utils.covariances.block_covariance">
<code class="sig-prename descclassname"><span class="pre">meegkit.utils.covariances.</span></code><code class="sig-name descname"><span class="pre">block_covariance</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overlap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">estimator</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cov'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.covariances.block_covariance" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Compute blockwise covariance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>array</em><em>, </em><em>shape=</em><em>(</em><em>n_chans</em><em>, </em><em>n_samples</em><em>)</em>) â Input data (must be 2D)</p></li>
<li><p><strong>window</strong> (<em>int</em>) â Window size.</p></li>
<li><p><strong>overlap</strong> (<em>float</em>) â Overlap between successive windows.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>cov</strong> â Block covariance.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array, shape=(n_blocks, n_chans, n_chans)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="meegkit.utils.covariances.convmtx">
<code class="sig-prename descclassname"><span class="pre">meegkit.utils.covariances.</span></code><code class="sig-name descname"><span class="pre">convmtx</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">V</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.covariances.convmtx" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Generate a convolution matrix.</p>
<p>CONVMTX(V,N) returns the convolution matrix for vector V. If V is a column
vector and X is a column vector of length N, then CONVMTX(V,N)*X is the
same as CONV(V,X). If R is a row vector and X is a row vector of length N,
then X*CONVMTX(R,N) is the same as CONV(R,X).</p>
<p>Given a vector V of length N, an N+n-1 by n convolution matrix is
generated of the following form:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="o">|</span>  <span class="n">V</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>  <span class="mi">0</span>      <span class="mi">0</span>     <span class="o">...</span>      <span class="mi">0</span>    <span class="o">|</span>
    <span class="o">|</span>  <span class="n">V</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="n">V</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>    <span class="mi">0</span>     <span class="o">...</span>      <span class="mi">0</span>    <span class="o">|</span>
    <span class="o">|</span>  <span class="n">V</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="n">V</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>   <span class="n">V</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>   <span class="o">...</span>      <span class="mi">0</span>    <span class="o">|</span>
<span class="n">X</span> <span class="o">=</span> <span class="o">|</span>   <span class="o">.</span>    <span class="o">.</span>      <span class="o">.</span>              <span class="o">.</span>    <span class="o">|</span>
    <span class="o">|</span>   <span class="o">.</span>    <span class="o">.</span>      <span class="o">.</span>              <span class="o">.</span>    <span class="o">|</span>
    <span class="o">|</span>   <span class="o">.</span>    <span class="o">.</span>      <span class="o">.</span>              <span class="o">.</span>    <span class="o">|</span>
    <span class="o">|</span>  <span class="n">V</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="n">V</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="n">V</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="o">...</span>  <span class="n">V</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">|</span>
    <span class="o">|</span>   <span class="mi">0</span>   <span class="n">V</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>   <span class="n">V</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">...</span>  <span class="n">V</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="n">n</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span> <span class="o">|</span>
    <span class="o">|</span>   <span class="o">.</span>    <span class="o">.</span>      <span class="o">.</span>              <span class="o">.</span>    <span class="o">|</span>
    <span class="o">|</span>   <span class="o">.</span>    <span class="o">.</span>      <span class="o">.</span>              <span class="o">.</span>    <span class="o">|</span>
    <span class="o">|</span>   <span class="mi">0</span>    <span class="mi">0</span>      <span class="mi">0</span>     <span class="o">...</span>    <span class="n">V</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>   <span class="o">|</span>
</pre></div>
</div>
<p>That is, V is assumed to be causal, and zero-valued after N.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>V</strong> (<em>array</em><em>, </em><em>shape=</em><em>(</em><em>N</em><em>,</em><em>) </em><em>or</em><em>(</em><em>N</em><em>, </em><em>1</em><em>) or </em><em>(</em><em>1</em><em>, </em><em>N</em><em>)</em>) â Input vector.</p></li>
<li><p><strong>n</strong> (<em>int</em>) â </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>t</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array, shape=(N * n - 1, n)</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Generate a simple convolution matrix:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">h</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">convmtx</span><span class="p">(</span><span class="n">h</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span>
<span class="go">np.array(</span>
<span class="go">    [[1. 2. 1. 0. 0. 0.]</span>
<span class="go">     [0. 1. 2. 1. 0. 0.]</span>
<span class="go">     [0. 0. 1. 2. 1. 0.]</span>
<span class="go">     [0. 0. 0. 1. 2. 1.]]</span>
<span class="go">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="meegkit.utils.covariances.cov_lags">
<code class="sig-prename descclassname"><span class="pre">meegkit.utils.covariances.</span></code><code class="sig-name descname"><span class="pre">cov_lags</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shifts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.covariances.cov_lags" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Empirical covariance of the joint array [X, Y] with lags.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array</em><em>, </em><em>shape=</em><em>(</em><em>n_times</em><em>, </em><em>n_chans_x</em><em>[</em><em>, </em><em>n_trials</em><em>]</em><em>)</em>) â Time shifted data.</p></li>
<li><p><strong>Y</strong> (<em>array</em><em>, </em><em>shape=</em><em>(</em><em>n_times</em><em>, </em><em>n_chans_y</em><em>[</em><em>, </em><em>n_trials</em><em>]</em><em>)</em>) â Reference data.</p></li>
<li><p><strong>shifts</strong> (<em>array</em><em>, </em><em>shape=</em><em>(</em><em>n_shifts</em><em>,</em><em>)</em>) â Positive lag means X is delayed relative to Y.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>C</strong> (<em>array, shape=(n_chans_x + n_chans_y, n_chans_x + n_chans_y, n_shifts)</em>) â Covariance matrix (3D if n_shifts &gt; 1).</p></li>
<li><p><strong>tw</strong> (<em>float</em>) â Total weight.</p></li>
<li><p><strong>m</strong> (<em>int</em>) â Number of columns in X.</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-obj docutils literal notranslate"><span class="pre">relshift</span></code>, <a class="reference internal" href="#meegkit.utils.covariances.tscov" title="meegkit.utils.covariances.tscov"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tscov</span></code></a>, <a class="reference internal" href="#meegkit.utils.covariances.tsxcov" title="meegkit.utils.covariances.tsxcov"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tsxcov</span></code></a></p>
</div>
</dd></dl>

<dl class="py function">
<dt id="meegkit.utils.covariances.nonlinear_eigenspace">
<code class="sig-prename descclassname"><span class="pre">meegkit.utils.covariances.</span></code><code class="sig-name descname"><span class="pre">nonlinear_eigenspace</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">L</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.covariances.nonlinear_eigenspace" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Nonlinear eigenvalue problem: total energy minimization.</p>
<p>This example is motivated in <a class="reference internal" href="#r82ca249c190f-1" id="id2">[1]</a> and was adapted from the manopt toolbox
in Matlab.</p>
<p>TODO : check this</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>L</strong> (<em>array</em><em>, </em><em>shape=</em><em>(</em><em>n_channels</em><em>, </em><em>n_channels</em><em>)</em>) â Discrete Laplacian operator: the covariance matrix.</p></li>
<li><p><strong>alpha</strong> (<em>float</em>) â Given constant for optimization problem.</p></li>
<li><p><strong>k</strong> (<em>int</em>) â Determines how many eigenvalues are returned.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>Xsol</strong> (<em>array, shape=(n_channels, n_channels)</em>) â Eigenvectors.</p></li>
<li><p><strong>S0</strong> (<em>array</em>) â Eigenvalues.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">References</p>
<dl class="citation">
<dt class="label" id="r82ca249c190f-1"><span class="brackets"><a class="fn-backref" href="#id2">1</a></span></dt>
<dd><p>âA Riemannian Newton Algorithm for Nonlinear Eigenvalue Problemsâ,
Zhi Zhao, Zheng-Jian Bai, and Xiao-Qing Jin, SIAM Journal on Matrix
Analysis and Applications, 36(2), 752-774, 2015.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="meegkit.utils.covariances.pca">
<code class="sig-prename descclassname"><span class="pre">meegkit.utils.covariances.</span></code><code class="sig-name descname"><span class="pre">pca</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cov</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_comps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.covariances.pca" title="Permalink to this definition">Â¶</a></dt>
<dd><p>PCA from covariance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cov</strong> (<em>array</em><em>, </em><em>shape=</em><em>(</em><em>n_chans</em><em>, </em><em>n_chans</em><em>)</em>) â Covariance matrix.</p></li>
<li><p><strong>max_comps</strong> (<em>int | None</em>) â Maximum number of components to retain after decomposition. <code class="docutils literal notranslate"><span class="pre">None</span></code>
(the default) keeps all suprathreshold components (see <code class="docutils literal notranslate"><span class="pre">thresh</span></code>).</p></li>
<li><p><strong>thresh</strong> (<em>float</em>) â Discard components below this threshold.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>V</strong> (<em>array, shape=(max_comps, max_comps)</em>) â Eigenvectors (matrix of PCA components).</p></li>
<li><p><strong>d</strong> (<em>array, shape=(max_comps,)</em>) â PCA eigenvalues</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="meegkit.utils.covariances.regcov">
<code class="sig-prename descclassname"><span class="pre">meegkit.utils.covariances.</span></code><code class="sig-name descname"><span class="pre">regcov</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Cxy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Cyy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([],</span> <span class="pre">dtype=float64)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([],</span> <span class="pre">dtype=float64)</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.covariances.regcov" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Compute regression matrix from cross covariance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Cxy</strong> (<em>array</em>) â Cross-covariance matrix between data and regressor.</p></li>
<li><p><strong>Cyy</strong> (<em>array</em>) â Covariance matrix of regressor.</p></li>
<li><p><strong>keep</strong> (<em>array</em>) â Number of regressor PCs to keep (default=all).</p></li>
<li><p><strong>threshold</strong> (<em>float</em>) â Eigenvalue threshold for discarding regressor PCs (default=0).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>R</strong> â Matrix to apply to regressor to best model data.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="meegkit.utils.covariances.tscov">
<code class="sig-prename descclassname"><span class="pre">meegkit.utils.covariances.</span></code><code class="sig-name descname"><span class="pre">tscov</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shifts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">assume_centered</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.covariances.tscov" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Time shift covariance.</p>
<p>This function calculates, for each pair [X[i], X[j]] of columns of X, the
cross-covariance matrix between the time-shifted versions of X[i].</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array</em><em>, </em><em>shape=</em><em>(</em><em>n_times</em><em>, </em><em>n_chans</em><em>[</em><em>, </em><em>n_trials</em><em>]</em><em>)</em>) â Data, can be 1D, 2D or 3D.</p></li>
<li><p><strong>shifts</strong> (<em>array</em><em>, </em><em>shape=</em><em>(</em><em>n_shifts</em><em>,</em><em>) </em><em>| None</em>) â Array of time shifts.</p></li>
<li><p><strong>weights</strong> (<em>array</em><em>, </em><em>shape=</em><em>(</em><em>n_times</em><em>,</em><em>) </em><em>or</em>) â <dl class="simple">
<dt>shape=(n_times, 1, n_trials), or</dt><dd><p>shape=(n_times, n_chans, n_trials)</p>
</dd>
</dl>
<p>Weights, 1D (if X is 1D or 2D) or 2D (if X is 3D). The weights are not
shifted.</p>
</p></li>
<li><p><strong>assume_centered</strong> (<em>bool</em>) â If False, remove the mean of X before computing the covariance
(default=True).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>C</strong> (<em>array, shape=(n_chans * n_shifts, n_chans * n_shifts)</em>) â Covariance matrix. This matrix is made up of a (n_times, n_times)
matrix of submatrices of dimensions (n_shifts, n_shifts).</p></li>
<li><p><strong>tw</strong> (<em>array</em>) â Total weight (C/tw is the normalized covariance).</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="meegkit.utils.covariances.tsxcov">
<code class="sig-prename descclassname"><span class="pre">meegkit.utils.covariances.</span></code><code class="sig-name descname"><span class="pre">tsxcov</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shifts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">assume_centered</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.covariances.tsxcov" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Calculate cross-covariance of X and time-shifted Y.</p>
<p>This function calculates, for each pair of columns (Xi, Yj) of X and Y, the
scalar products between Xi and time-shifted versions of Yj.</p>
<p>Output is a 2D matrix with dimensions .</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>arrays</em><em>, </em><em>shape=</em><em>(</em><em>n_times</em><em>, </em><em>n_chans</em><em>[</em><em>, </em><em>n_trials</em><em>]</em><em>)</em>) â Data to cross correlate. X can be 1D, 2D or 3D.</p></li>
<li><p><strong>Y</strong> (<em>arrays</em><em>, </em><em>shape=</em><em>(</em><em>n_times</em><em>, </em><em>n_chans</em><em>[</em><em>, </em><em>n_trials</em><em>]</em><em>)</em>) â Data to cross correlate. X can be 1D, 2D or 3D.</p></li>
<li><p><strong>shifts</strong> (<em>array</em>) â Time shifts.</p></li>
<li><p><strong>weights</strong> (<em>array</em>) â The weights that are applied to X. 1D (if X is 1D or 2D) or 2D (if X is
3D).</p></li>
<li><p><strong>assume_centered</strong> (<em>bool</em>) â If False, remove the mean of X before computing the covariance
(default=True).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>C</strong> (<em>array, shape=(n_chans_x, n_chans_y * n_shifts)</em>) â Cross-covariance matrix.</p></li>
<li><p><strong>tw</strong> (<em>total weight</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="module-meegkit.utils.denoise">
<span id="denoising"></span><h2>Denoising<a class="headerlink" href="#module-meegkit.utils.denoise" title="Permalink to this headline">Â¶</a></h2>
<p>Denoising utilities.</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
</tbody>
</table>
<dl class="py function">
<dt id="meegkit.utils.denoise.demean">
<code class="sig-prename descclassname"><span class="pre">meegkit.utils.denoise.</span></code><code class="sig-name descname"><span class="pre">demean</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_mean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.denoise.demean" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Remove weighted mean over rows (samples).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array</em><em>, </em><em>shape=</em><em>(</em><em>n_samples</em><em>, </em><em>n_channels</em><em>[</em><em>, </em><em>n_trials</em><em>]</em><em>)</em>) â Data.</p></li>
<li><p><strong>weights</strong> (<em>array</em><em>, </em><em>shape=</em><em>(</em><em>n_samples</em><em>)</em>) â </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>demeaned_X</strong> (<em>array, shape=(n_samples, n_channels[, n_trials])</em>) â Centered data.</p></li>
<li><p><strong>mn</strong> (<em>array</em>) â Mean value.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="meegkit.utils.denoise.find_outlier_samples">
<code class="sig-prename descclassname"><span class="pre">meegkit.utils.denoise.</span></code><code class="sig-name descname"><span class="pre">find_outlier_samples</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">toobig1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">toobig2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.denoise.find_outlier_samples" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Find outlier trials using an absolute threshold.</p>
</dd></dl>

<dl class="py function">
<dt id="meegkit.utils.denoise.find_outlier_trials">
<code class="sig-prename descclassname"><span class="pre">meegkit.utils.denoise.</span></code><code class="sig-name descname"><span class="pre">find_outlier_trials</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.denoise.find_outlier_trials" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Find outlier trials.</p>
<p>For example thresh=2 rejects trials that deviate from the mean by
more than twice the average deviation from the mean.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>ndarray</em><em>, </em><em>shape=</em><em>(</em><em>n_times</em><em>, </em><em>n_chans</em><em>[</em><em>, </em><em>n_trials</em><em>]</em><em>)</em>) â Data array.</p></li>
<li><p><strong>thresh</strong> (<em>float</em><em> or </em><em>array of floats</em>) â Keep trials less than thresh from mean.</p></li>
<li><p><strong>show</strong> (<em>bool</em>) â If true plot trial deviations before and after.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>bads</strong> (<em>list of int</em>) â Indices of trials to reject.</p></li>
<li><p><strong>d</strong> (<em>array</em>) â Relative deviations from mean.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="meegkit.utils.denoise.mean_over_trials">
<code class="sig-prename descclassname"><span class="pre">meegkit.utils.denoise.</span></code><code class="sig-name descname"><span class="pre">mean_over_trials</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.denoise.mean_over_trials" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Compute weighted mean over trials (last dimension).</p>
</dd></dl>

<dl class="py function">
<dt id="meegkit.utils.denoise.wpwr">
<code class="sig-prename descclassname"><span class="pre">meegkit.utils.denoise.</span></code><code class="sig-name descname"><span class="pre">wpwr</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.denoise.wpwr" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Weighted power.</p>
</dd></dl>

<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="module-meegkit.utils.matrix">
<span id="matrix-manipulation"></span><h2>Matrix manipulation<a class="headerlink" href="#module-meegkit.utils.matrix" title="Permalink to this headline">Â¶</a></h2>
<p>Matrix operation utility functions.</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
</tbody>
</table>
<dl class="py function">
<dt id="meegkit.utils.matrix.fold">
<code class="sig-prename descclassname"><span class="pre">meegkit.utils.matrix.</span></code><code class="sig-name descname"><span class="pre">fold</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epoch_size</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.matrix.fold" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Fold 2D X into 3D.</p>
</dd></dl>

<dl class="py function">
<dt id="meegkit.utils.matrix.matmul3d">
<code class="sig-prename descclassname"><span class="pre">meegkit.utils.matrix.</span></code><code class="sig-name descname"><span class="pre">matmul3d</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mixin</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.matrix.matmul3d" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Apply mixing matrix to each trial of X.</p>
<p>This is a simple wrapper or np.einsum.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array</em><em>, </em><em>shape=</em><em>(</em><em>n_samples</em><em>, </em><em>n_chans</em><em>, </em><em>n_trials</em><em>)</em>) â </p></li>
<li><p><strong>mixing</strong> (<em>array</em><em>, </em><em>shape=</em><em>(</em><em>n_chans</em><em>, </em><em>n_components</em><em>)</em>) â </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>proj</strong> â Projection.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array, shape=(n_samples, n_components, n_trials)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="meegkit.utils.matrix.multishift">
<code class="sig-prename descclassname"><span class="pre">meegkit.utils.matrix.</span></code><code class="sig-name descname"><span class="pre">multishift</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shifts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep_dims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reshape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solution</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'full'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.matrix.multishift" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Apply several shifts along specified axis.</p>
<p>If <cite>shifts</cite> has multiple values, the output will contain one shift per
page. Shifted data are padded with <cite>fill_value</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array</em><em>, </em><em>shape=</em><em>(</em><em>n_samples</em><em>[</em><em>, </em><em>n_chans</em><em>]</em><em>[</em><em>, </em><em>n_trials</em><em>]</em><em>)</em>) â Array to shift.</p></li>
<li><p><strong>shifts</strong> (<em>array</em><em>, </em><em>shape=</em><em>(</em><em>n_shifts</em><em>,</em><em>)</em>) â Array of shifts. Positive shifts mean that X is âdelayedâ in time (i.e.
<cite>y[shift] = X[0]</cite>). Conversely, a negative shift means that X is
âadvancedâ (i.e. y[0] =</p></li>
<li><p><strong>fill_value</strong> (<em>float | np.nan</em>) â Value to pad output axis by.</p></li>
<li><p><strong>axis</strong> (<em>int</em><em>, </em><em>optional</em>) â The axis along which elements are shifted.</p></li>
<li><p><strong>keep_dims</strong> (<em>bool</em>) â If True, keep singleton dimensions in output.</p></li>
<li><p><strong>reshape</strong> (<em>bool</em>) â If True, concatenate channels and lags, yielding an array of shape
(n_samples, n_chans*n_shifts[, n_trials])</p></li>
<li><p><strong>solution</strong> (<em>{'valid'</em><em>, </em><em>'full'}</em>) â If <cite>valid</cite>, the outputâs is cropped along <cite>axis</cite> by <cite>n_shifts</cite> in order
to remove edge artifacts. If <cite>full</cite>, the output has the same size as X.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>y</strong> â Shifted array.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array, shape=(n_samples[, n_chans][, n_trials], n_shifts)</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#meegkit.utils.matrix.relshift" title="meegkit.utils.matrix.relshift"><code class="xref py py-obj docutils literal notranslate"><span class="pre">relshift</span></code></a>, <a class="reference internal" href="#meegkit.utils.matrix.shift" title="meegkit.utils.matrix.shift"><code class="xref py py-obj docutils literal notranslate"><span class="pre">shift</span></code></a>, <a class="reference internal" href="#meegkit.utils.matrix.shiftnd" title="meegkit.utils.matrix.shiftnd"><code class="xref py py-obj docutils literal notranslate"><span class="pre">shiftnd</span></code></a></p>
</div>
</dd></dl>

<dl class="py function">
<dt id="meegkit.utils.matrix.multismooth">
<code class="sig-prename descclassname"><span class="pre">meegkit.utils.matrix.</span></code><code class="sig-name descname"><span class="pre">multismooth</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smooths</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep_dims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.matrix.multismooth" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Apply several shifts along specified axis.</p>
<p>If <cite>shifts</cite> has multiple values, the output will contain one shift per
trial. Shifted data are padded with <cite>fill_value</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array</em><em>, </em><em>shape=</em><em>(</em><em>n_samples</em><em>[</em><em>, </em><em>n_epochs</em><em>]</em><em>[</em><em>, </em><em>n_trials</em><em>]</em><em>)</em>) â Array to shift.</p></li>
<li><p><strong>smooths</strong> (<em>array</em>) â Array of smoothing values (in samples).</p></li>
<li><p><strong>axis</strong> (<em>int</em><em>, </em><em>optional</em>) â The axis along which elements are shifted (default=0).</p></li>
<li><p><strong>keep_dims</strong> (<em>bool</em>) â If True, keep singleton dimensions in output.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>y</strong> â Shifted array.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array, shape=(n_samples[, n_epochs][, n_trials], n_shifts)</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#meegkit.utils.matrix.multishift" title="meegkit.utils.matrix.multishift"><code class="xref py py-obj docutils literal notranslate"><span class="pre">multishift</span></code></a>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">smooth</span></code></p>
</div>
</dd></dl>

<dl class="py function">
<dt id="meegkit.utils.matrix.normcol">
<code class="sig-prename descclassname"><span class="pre">meegkit.utils.matrix.</span></code><code class="sig-name descname"><span class="pre">normcol</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.matrix.normcol" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Normalize each column so that its weighted mean square value is 1.</p>
<p>If X is 3D, pages are concatenated vertically before calculating the
norm.</p>
<p>Weight should be either a column vector, or a matrix (2D or 3D) of same
size as X.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array</em>) â X to normalize.</p></li>
<li><p><strong>weights</strong> (<em>array</em>) â Weights.</p></li>
<li><p><strong>return_norm</strong> (<em>bool</em>) â If True, also return norm vector.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>X_norm</strong> (<em>array</em>) â Normalized X.</p></li>
<li><p><strong>norm</strong> (<em>array</em>) â Norm.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="meegkit.utils.matrix.relshift">
<code class="sig-prename descclassname"><span class="pre">meegkit.utils.matrix.</span></code><code class="sig-name descname"><span class="pre">relshift</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shifts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.matrix.relshift" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Create shifted versions of X relative to ref with padding.</p>
<p><cite>ref</cite> is replicated to have the same shape as <cite>X</cite> and padded accordingly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array</em><em>, </em><em>shape=</em><em>(</em><em>n_samples</em><em>[</em><em>, </em><em>n_epochs</em><em>]</em><em>[</em><em>, </em><em>n_trials</em><em>]</em><em>)</em>) â Array to shift.</p></li>
<li><p><strong>ref</strong> (<em>array</em><em>, </em><em>shape=</em><em>(</em><em>n_samples</em><em>[</em><em>, </em><em>n_epochs</em><em>]</em><em>[</em><em>, </em><em>n_trials</em><em>]</em><em>)</em>) â Reference array against which <cite>X</cite> is shifted.</p></li>
<li><p><strong>shifts</strong> (<em>array | int</em>) â Array of shifts. Positive shifts mean that X is âdelayedâ in time (i.e.
<cite>y[shift] = X[0]</cite>). Conversely, a negative shift means that X is
âadvancedâ (i.e. y[0] =</p></li>
<li><p><strong>fill_value</strong> (<em>float</em>) â Value to pad output axis by.</p></li>
<li><p><strong>axis</strong> (<em>int</em>) â The axis along which elements are shifted.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>y</strong> (<em>array, shape=(n_samples[, n_epochs][, n_trials], n_shifts)</em>) â Shifted array.</p></li>
<li><p><strong>y_ref</strong> (<em>array, shape=(n_samples[, n_epochs][, n_trials], n_shifts)</em>) â Reference array, repeated to match <cite>y.shape</cite>. Padding matches that of
<cite>y</cite>.</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#meegkit.utils.matrix.multishift" title="meegkit.utils.matrix.multishift"><code class="xref py py-obj docutils literal notranslate"><span class="pre">multishift</span></code></a>, <a class="reference internal" href="#meegkit.utils.matrix.shift" title="meegkit.utils.matrix.shift"><code class="xref py py-obj docutils literal notranslate"><span class="pre">shift</span></code></a>, <a class="reference internal" href="#meegkit.utils.matrix.shiftnd" title="meegkit.utils.matrix.shiftnd"><code class="xref py py-obj docutils literal notranslate"><span class="pre">shiftnd</span></code></a></p>
</div>
</dd></dl>

<dl class="py function">
<dt id="meegkit.utils.matrix.shift">
<code class="sig-prename descclassname"><span class="pre">meegkit.utils.matrix.</span></code><code class="sig-name descname"><span class="pre">shift</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shift</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.matrix.shift" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Shift array along its first, second or last dimension.</p>
<p>Output is padded by <cite>fill_value</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array</em><em>, </em><em>shape=</em><em>(</em><em>n_samples</em><em>[</em><em>, </em><em>n_epochs</em><em>]</em><em>[</em><em>, </em><em>n_trials</em><em>]</em><em>)</em>) â Multidimensional input array.</p></li>
<li><p><strong>shift</strong> (<em>int</em>) â The number of places by which elements are shifted along axis. Positive
shifts mean that X is âdelayedâ in time (i.e. <cite>y[shift] = X[0]</cite>).
Conversely, a negative shift means that X is âadvancedâ (i.e. y[0] =
X[shift]).</p></li>
<li><p><strong>fill_value</strong> (<em>float</em>) â Value to pad output axis by.</p></li>
<li><p><strong>axis</strong> (<em>int</em><em>, </em><em>optional</em>) â The axis along which elements are shifted.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>y</strong> â Output array, with the same shape as <cite>X</cite>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#meegkit.utils.matrix.relshift" title="meegkit.utils.matrix.relshift"><code class="xref py py-obj docutils literal notranslate"><span class="pre">relshift</span></code></a>, <a class="reference internal" href="#meegkit.utils.matrix.multishift" title="meegkit.utils.matrix.multishift"><code class="xref py py-obj docutils literal notranslate"><span class="pre">multishift</span></code></a>, <a class="reference internal" href="#meegkit.utils.matrix.shiftnd" title="meegkit.utils.matrix.shiftnd"><code class="xref py py-obj docutils literal notranslate"><span class="pre">shiftnd</span></code></a></p>
</div>
</dd></dl>

<dl class="py function">
<dt id="meegkit.utils.matrix.shiftnd">
<code class="sig-prename descclassname"><span class="pre">meegkit.utils.matrix.</span></code><code class="sig-name descname"><span class="pre">shiftnd</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shift</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.matrix.shiftnd" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Roll array elements along a given axis with padding.</p>
<p>Elements off the end of the array are treated as zeros. This function is
slower than function:<cite>shift</cite>, so prefer the latter when possible.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array</em>) â Multidimensional input array.</p></li>
<li><p><strong>shift</strong> (<em>int</em>) â The number of places by which elements are shifted along axis.</p></li>
<li><p><strong>fill_value</strong> (<em>float</em>) â Value to pad output axis by.</p></li>
<li><p><strong>axis</strong> (<em>int</em><em>, </em><em>optional</em>) â The axis along which elements are shifted. By default, the array is
flattened before shifting, after which the original shape is restored.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>y</strong> â Output array, with the same shape as <cite>X</cite>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array, (n_samples, [n_epochs, ][n_trials, ])</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">np.roll</span></code></dt><dd><p>Elements that roll off one end come back on the other.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">np.rollaxis</span></code></dt><dd><p>Roll the specified axis backwards, until it lies in a given position.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shiftnd</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">array([0, 0, 0, 1, 2, 3, 4, 5, 6, 7])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x2</span>
<span class="go">array([[0, 1, 2, 3, 4],</span>
<span class="go">       [5, 6, 7, 8, 9]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shiftnd</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">array([[0, 0, 1, 2, 3],</span>
<span class="go">       [4, 5, 6, 7, 8]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shiftnd</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="go">array([[2, 3, 4, 5, 6],</span>
<span class="go">       [7, 8, 9, 0, 0]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shiftnd</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">array([[0, 0, 0, 0, 0],</span>
<span class="go">       [0, 1, 2, 3, 4]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shiftnd</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">array([[5, 6, 7, 8, 9],</span>
<span class="go">       [0, 0, 0, 0, 0]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shiftnd</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">array([[0, 0, 1, 2, 3],</span>
<span class="go">       [0, 5, 6, 7, 8]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="meegkit.utils.matrix.sliding_window">
<code class="sig-prename descclassname"><span class="pre">meegkit.utils.matrix.</span></code><code class="sig-name descname"><span class="pre">sliding_window</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padded</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">copy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.matrix.sliding_window" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Calculate a sliding window over a signal.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>array</em>) â The array to be slided over.</p></li>
<li><p><strong>window</strong> (<em>int</em>) â The sliding window size.</p></li>
<li><p><strong>step</strong> (<em>int</em>) â The sliding window stepsize (default=1).</p></li>
<li><p><strong>axis</strong> (<em>int</em>) â The axis to slide over (defaults=-1).</p></li>
<li><p><strong>copy</strong> (<em>bool</em>) â Return strided array as copy to avoid sideffects when manipulating the
output array.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>data</strong> â A matrix whose last dimension corresponds to the window size, and the
second-to-last dimension corresponds to the number of slices.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array, shape=(.., n_windows, window_size)</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Be wary of setting <cite>copy</cite> to <cite>False</cite> as undesired sideffects with the
output values may occur.</p></li>
</ul>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sliding_window</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="go">array([[1, 2, 3],</span>
<span class="go">       [2, 3, 4],</span>
<span class="go">       [3, 4, 5]])</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sliding_window</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">stepsize</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="go">array([[1, 2, 3],</span>
<span class="go">       [3, 4, 5]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="meegkit.utils.matrix.theshapeof">
<code class="sig-prename descclassname"><span class="pre">meegkit.utils.matrix.</span></code><code class="sig-name descname"><span class="pre">theshapeof</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.matrix.theshapeof" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return the shape of X.</p>
</dd></dl>

<dl class="py function">
<dt id="meegkit.utils.matrix.unfold">
<code class="sig-prename descclassname"><span class="pre">meegkit.utils.matrix.</span></code><code class="sig-name descname"><span class="pre">unfold</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.matrix.unfold" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Unfold 3D X into 2D (concatenate trials).</p>
</dd></dl>

<dl class="py function">
<dt id="meegkit.utils.matrix.unsqueeze">
<code class="sig-prename descclassname"><span class="pre">meegkit.utils.matrix.</span></code><code class="sig-name descname"><span class="pre">unsqueeze</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.matrix.unsqueeze" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Append singleton dimensions to an array.</p>
</dd></dl>

<dl class="py function">
<dt id="meegkit.utils.matrix.widen_mask">
<code class="sig-prename descclassname"><span class="pre">meegkit.utils.matrix.</span></code><code class="sig-name descname"><span class="pre">widen_mask</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">widen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.matrix.widen_mask" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Widen each âbadâ section of a binary mask by <cite>n</cite> cells.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mask</strong> (<em>array</em>) â Masking array. If an element of the mask is True (or 1), the
corresponding element of the associated array is masked (marked as
invalid).</p></li>
<li><p><strong>widen</strong> (<em>int</em>) â Number of cells to widen mask by.</p></li>
<li><p><strong>axis</strong> (<em>int</em>) â Axis to operate on.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>out</strong> â Widened mask, of same shape as input mask.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">test</span> <span class="o">=</span> <span class="n">widen_mask</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">test</span><span class="p">)</span>
<span class="go">[False False False True True]]</span>
</pre></div>
</div>
</dd></dl>

<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="module-meegkit.utils.sig">
<span id="signal"></span><h2>Signal<a class="headerlink" href="#module-meegkit.utils.sig" title="Permalink to this headline">Â¶</a></h2>
<p>Audio and signal processing tools.</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
</tbody>
</table>
<dl class="py function">
<dt id="meegkit.utils.sig.gaussfilt">
<code class="sig-prename descclassname"><span class="pre">meegkit.utils.sig.</span></code><code class="sig-name descname"><span class="pre">gaussfilt</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">srate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fwhm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_harm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shift</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_empvals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.sig.gaussfilt" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Narrow-band filter via frequency-domain Gaussian.</p>
<p>Empirical frequency and FWHM depend on the sampling rate and the
number of time points, and may thus be slightly different from
the requested values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>ndarray</em>) â EEG data, shape=(n_samples, n_channels[, â¦])</p></li>
<li><p><strong>srate</strong> (<em>int</em>) â Sampling rate in Hz.</p></li>
<li><p><strong>f</strong> (<em>float</em>) â Break frequency of filter.</p></li>
<li><p><strong>fhwm</strong> (<em>float</em>) â Standard deviation of filter, defined as full-width at half-maximum
in Hz.</p></li>
<li><p><strong>n_harm</strong> (<em>int</em>) â Number of harmonics of the frequency to consider.</p></li>
<li><p><strong>shift</strong> (<em>int</em>) â Amount shift peak frequency by (only useful when considering harmonics,
otherwise leave to 0).</p></li>
<li><p><strong>return_empvals</strong> (<em>bool</em>) â Return empirical values (default: False).</p></li>
<li><p><strong>show</strong> (<em>bool</em>) â Set to True to show the frequency-domain filter shape.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>filtdat</strong> (<em>ndarray</em>) â Filtered data.</p></li>
<li><p><strong>empVals</strong> (<em>float</em>) â The empirical frequency and FWHM.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="meegkit.utils.sig.hilbert_envelope">
<code class="sig-prename descclassname"><span class="pre">meegkit.utils.sig.</span></code><code class="sig-name descname"><span class="pre">hilbert_envelope</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.sig.hilbert_envelope" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Calculate the Hilbert envelope of a signal.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>x</strong> (<em>array</em>) â Signal on which to calculate the hilbert envelope. The calculation
is done along the last axis (i.e. <code class="docutils literal notranslate"><span class="pre">axis=-1</span></code>).</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="meegkit.utils.sig.lowpass_env_filtering">
<code class="sig-prename descclassname"><span class="pre">meegkit.utils.sig.</span></code><code class="sig-name descname"><span class="pre">lowpass_env_filtering</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">150.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sfreq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">22050</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.sig.lowpass_env_filtering" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Low-pass filters a signal using a Butterworth filter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>ndarray</em>) â </p></li>
<li><p><strong>cutoff</strong> (<em>float</em><em>, </em><em>optional</em>) â Cut-off frequency of the low-pass filter, in Hz. The default is 150 Hz.</p></li>
<li><p><strong>n</strong> (<em>int</em><em>, </em><em>optional</em>) â Order of the low-pass filter. The default is 1.</p></li>
<li><p><strong>sfreq</strong> (<em>float</em><em>, </em><em>optional</em>) â Sampling frequency of the signal to filter. The default is 22050 Hz.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Low-pass filtered signal.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="meegkit.utils.sig.modulation_index">
<code class="sig-prename descclassname"><span class="pre">meegkit.utils.sig.</span></code><code class="sig-name descname"><span class="pre">modulation_index</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phase</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">18</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.sig.modulation_index" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Compute the Modulation Index (MI) between two signals.</p>
<p>MI is a measure of the amount of phase-amplitude coupling. Phase angles are
expected to be in radians <a class="reference internal" href="#r44b01ae0e3d3-1" id="id3">[1]</a>. MI is derived from the Kullbach-Leibner
distance, a measure for the disparity of two distributions, which is also
returned here. MI is recommend the modulation index for noisy and short
data epochs with unknown forms of coupling <a class="reference internal" href="#r44b01ae0e3d3-2" id="id4">[2]</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>phase</strong> (<em>array</em>) â Phase vector, in radians.</p></li>
<li><p><strong>amp</strong> (<em>array</em>) â Amplitude vector.</p></li>
<li><p><strong>n_bins</strong> (<em>int</em>) â Number of bins in which to discretize phase (default=18 bins, giving
a 20-degree resolution).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>MI</strong> (<em>array</em>) â Tortâs Modulation index.</p></li>
<li><p><strong>KL</strong> (<em>array</em>) â Kullbach-Leibner distance.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>&gt;&gt; phas = np.random.rand(100, 1) * 2 * np.pi - np.pi
&gt;&gt; ampl = np.random.randn(100, 1) * 30 + 100
&gt;&gt; MI, KL = modulation_index(phas, ampl)</p>
<p class="rubric">Notes</p>
<p>Phase and amplitude can be derived directly from any time series through
the analytic signal:
&gt;&gt; analytic_signal = hilbert(filtered_data)
&gt;&gt; phase = np.phase(analytic_signal)
&gt;&gt; amplitude = np.abs(analytic_signal)</p>
<p>MI can be subjected to permutation testing to assess significance. For
permutation testing, the observed coupling value is compared to a
distribution of shuffled coupling values. Shuffled coupling values are
constructed by calculating the coupling value between the original phase
time series and a permuted amplitude time series. The permuted amplitude
time series can be constructed by cutting the amplitude time series at a
random time point and reversing the order of both parts <a class="reference internal" href="#r44b01ae0e3d3-2" id="id5">[2]</a>. The observed
coupling value is standardized to the distribution of the shuffled coupling
values according to the following formula:</p>
<p>MI_z = (MI_observed â Âµ_MI_shuffled) / Ï_MI_shuffled</p>
<p>where Î¼ denotes the mean and Ï the standard deviation. Only when the
observed phase-locking value is larger than 95% of shuffled values, it is
defined as significant. See <a class="reference internal" href="#r44b01ae0e3d3-2" id="id6">[2]</a> for details.</p>
<p class="rubric">References</p>
<dl class="citation">
<dt class="label" id="r44b01ae0e3d3-1"><span class="brackets"><a class="fn-backref" href="#id3">1</a></span></dt>
<dd><p>Tort AB, Komorowski R, Eichenbaum H, Kopell N. Measuring
phase-amplitude coupling between neuronal oscillations of different
frequencies. J Neurophysiol. 2010 Aug;104(2):1195-210. doi:
10.1152/jn.00106.2010.</p>
</dd>
<dt class="label" id="r44b01ae0e3d3-2"><span class="brackets">2</span><span class="fn-backref">(<a href="#id4">1</a>,<a href="#id5">2</a>,<a href="#id6">3</a>)</span></dt>
<dd><p>Huelsemann, M. J., Naumann, E., &amp; Rasch, B. (2018). Quantification
of Phase-Amplitude Coupling in Neuronal Oscillations: Comparison of
Phase-Locking Value, Mean Vector Length, and Modulation Index. bioRxiv,
290361.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="meegkit.utils.sig.prony">
<code class="sig-prename descclassname"><span class="pre">meegkit.utils.sig.</span></code><code class="sig-name descname"><span class="pre">prony</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">na</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.sig.prony" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Pronyâs method for time-domain IIR filter design.</p>
<p>[B,A] = PRONY(H, NB, NA) finds a filter with numerator order NB,
denominator order NA, and having the impulse response in vector H. The IIR
filter coefficients are returned in length NB+1 and NA+1 row vectors B and
A, ordered in descending powers of Z.  H may be real or complex.</p>
<p>If the largest order specified is greater than the length of H, H is padded
with zeros.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>h</strong> (<em>array</em>) â Impulse response.</p></li>
<li><p><strong>nb</strong> (<em>int</em>) â Numerator order.</p></li>
<li><p><strong>na</strong> (<em>int</em>) â Denominator order.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">References</p>
<p>T.W. Parks and C.S. Burrus, Digital Filter Design, John Wiley and Sons,
1987, p226.</p>
<p class="rubric">Notes</p>
<p>Copyright 1988-2012 The MathWorks, Inc.</p>
</dd></dl>

<dl class="py function">
<dt id="meegkit.utils.sig.slope_sum">
<code class="sig-prename descclassname"><span class="pre">meegkit.utils.sig.</span></code><code class="sig-name descname"><span class="pre">slope_sum</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.sig.slope_sum" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Slope sum function.</p>
<p>The discrete version of the Teager-Kaiser operator is computed according
to:</p>
<p>y[n] = \sum_{i=k-w}^k (y_i -y_{i-1})</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>array</em><em>, </em><em>shape=</em><em>(</em><em>n_samples</em><em>[</em><em>, </em><em>n_channels</em><em>]</em><em>[</em><em>, </em><em>n_trials</em><em>]</em><em>)</em>) â Input data.</p></li>
<li><p><strong>w</strong> (<em>int</em>) â Window.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">References</p>
<p><a class="reference external" href="https://ieeexplore.ieee.org/document/8527395">https://ieeexplore.ieee.org/document/8527395</a></p>
</dd></dl>

<dl class="py function">
<dt id="meegkit.utils.sig.smooth">
<code class="sig-prename descclassname"><span class="pre">meegkit.utils.sig.</span></code><code class="sig-name descname"><span class="pre">smooth</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_len</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'square'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">align</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'left'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.sig.smooth" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Smooth a signal using a window with requested size along a given axis.</p>
<p>This method is based on the convolution of a scaled window with the signal.
The signal is prepared by introducing reflected copies of the signal (with
the window size) in both ends so that transient parts are minimized in the
beginning and end part of the output signal.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>array</em>) â The input signal.</p></li>
<li><p><strong>window_len</strong> (<em>float</em>) â The dimension of the smoothing window (in samples). Can be fractionary.</p></li>
<li><p><strong>window</strong> (<em>str</em>) â The type of window from âflatâ, âhanningâ, âhammingâ, âbartlettâ,
âblackmanâ flat window will produce a moving average smoothing.</p></li>
<li><p><strong>axis</strong> (<em>int</em>) â Axis along which smoothing will be applied (default=0).</p></li>
<li><p><strong>align</strong> (<em>{'left' | 'center'}</em>) â If <cite>left</cite> (default), the convolution if computed in a causal way by
shifting the output of a normal convolution by the kernel size. If
<cite>center</cite>, the center of the impulse is used as the location where the
convolution is summed.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>y</strong> â The smoothed signal.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>&gt;&gt; t = linspace(-2, 2, 0.1)
&gt;&gt; x = sin(t) + randn(len(t)) * 0.1
&gt;&gt; y = smooth(x, 2)</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-obj docutils literal notranslate"><span class="pre">np.hanning</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">np.hamming</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">np.bartlett</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">np.blackman</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">np.convolve</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">scipy.signal.lfilter</span></code></p>
</div>
<p class="rubric">Notes</p>
<p>length(output) != length(input), to correct this, we return :
&gt;&gt; y[(window_len / 2 - 1):-(window_len / 2)]  # noqa
instead of just y.</p>
</dd></dl>

<dl class="py function">
<dt id="meegkit.utils.sig.spectral_envelope">
<code class="sig-prename descclassname"><span class="pre">meegkit.utils.sig.</span></code><code class="sig-name descname"><span class="pre">spectral_envelope</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sfreq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lowpass</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">32</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.sig.spectral_envelope" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Compute envelope with convolution.</p>
<p class="rubric">Notes</p>
<p>The signal is first padded to avoid edge effects. To align the envelope
with the input signal, we return :
&gt;&gt; y[(window_len / 2 - 1):-(window_len / 2)]  # noqa</p>
</dd></dl>

<dl class="py function">
<dt id="meegkit.utils.sig.stmcb">
<code class="sig-prename descclassname"><span class="pre">meegkit.utils.sig.</span></code><code class="sig-name descname"><span class="pre">stmcb</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u_in</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">niter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a_in</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.sig.stmcb" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Compute linear model via Steiglitz-McBride iteration.</p>
<p>[B,A] = stmcb(H,NB,NA) finds the coefficients of the system B(z)/A(z) with
approximate impulse response H, NA poles and NB zeros.</p>
<p>[B,A] = stmcb(H,NB,NA,N) uses N iterations.  N defaults to 5.</p>
<p>[B,A] = stmcb(H,NB,NA,N,Ai) uses the vector Ai as the initial
guess at the denominator coefficients. If you donât specify Ai,
STMCB uses [B,Ai] = PRONY(H,0,NA) as the initial conditions.</p>
<p>[B,A] = STMCB(X,Y,NB,NA,N,Ai) finds the system coefficients B and
A of the system which, given X as input, has Y as output. N and Ai
are again optional with default values of N = 5, [B,Ai] = PRONY(Y,0,NA).
Y and X must be the same length.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>array</em>) â </p></li>
<li><p><strong>u_in</strong> (<em>array</em>) â </p></li>
<li><p><strong>q</strong> (<em>int</em>) â </p></li>
<li><p><strong>p</strong> (<em>int</em>) â </p></li>
<li><p><strong>n_iter</strong> (<em>int</em>) â </p></li>
<li><p><strong>a_in</strong> (<em>array</em>) â </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>b</strong> (<em>array</em>) â Filter coefficients (denominator).</p></li>
<li><p><strong>a</strong> (<em>array</em>) â Filter coefficients (numerator).</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Approximate the impulse response of a Butterworth filter with a
system of lower order:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="n">butter</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">)</span>                <span class="c1"># Butterworth filter design</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h</span> <span class="o">=</span> <span class="nb">filter</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">zeros</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">100</span><span class="p">)])</span>    <span class="c1"># Filter data using above filter</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">freqz</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="mi">128</span><span class="p">)</span>                       <span class="c1"># Frequency response</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="n">bb</span><span class="p">,</span> <span class="n">aa</span><span class="p">]</span> <span class="o">=</span> <span class="n">stmcb</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freqz</span><span class="p">(</span><span class="n">bb</span><span class="p">,</span> <span class="n">aa</span><span class="p">,</span> <span class="mi">128</span><span class="p">))</span>
</pre></div>
</div>
<p class="rubric">References</p>
<p>Authors: Jim McClellan, 2-89 T. Krauss, 4-22-93, new help and options
Copyright 1988-2004 The MathWorks, Inc.</p>
</dd></dl>

<dl class="py function">
<dt id="meegkit.utils.sig.teager_kaiser">
<code class="sig-prename descclassname"><span class="pre">meegkit.utils.sig.</span></code><code class="sig-name descname"><span class="pre">teager_kaiser</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">M</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.sig.teager_kaiser" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Mean Teager-Kaiser energy operator.</p>
<p>The discrete version of the Teager-Kaiser operator is computed according
to:</p>
<p>y[n] = x[n] ** {2 / m} - (x[n - M] * x[n + M]) ** {1 / m}</p>
<p>with m the exponent parameter and M the lag parameter which both are
usually equal to 1 for a conventional operator. The Teaser-Kaiser operator
can be used to track amplitude modulations (AM) and/or frequency
modulations (FM).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>array</em><em>, </em><em>shape=</em><em>(</em><em>n_samples</em><em>[</em><em>, </em><em>n_channels</em><em>]</em><em>[</em><em>, </em><em>n_trials</em><em>]</em><em>)</em>) â Input data.</p></li>
<li><p><strong>m</strong> (<em>int</em>) â Exponent parameter.</p></li>
<li><p><strong>M</strong> (<em>int</em>) â Lag parameter.</p></li>
<li><p><strong>axis</strong> (<em>int</em>) â Axis to compute metric on.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Instantaneous energy.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array, shape=(n_samples - 2 * M[, n_channels][, n_trials])</p>
</dd>
</dl>
<p class="rubric">References</p>
<p>Adapted from the TKEO function in R library <cite>seewave</cite>.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tk_energy</span> <span class="o">=</span> <span class="n">teager_kaiser</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="module-meegkit.utils.stats">
<span id="statistics"></span><h2>Statistics<a class="headerlink" href="#module-meegkit.utils.stats" title="Permalink to this headline">Â¶</a></h2>
<p>Statistics utilities.</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
</tbody>
</table>
<dl class="py function">
<dt id="meegkit.utils.stats.bootstrap_ci">
<code class="sig-prename descclassname"><span class="pre">meegkit.utils.stats.</span></code><code class="sig-name descname"><span class="pre">bootstrap_ci</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_bootstrap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(5,</span> <span class="pre">95)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.stats.bootstrap_ci" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Confidence intervals from non-parametric bootstrap resampling.</p>
<p>Bootstrap is computed over the chosen axis, <em>with</em> replacement. By default,
the resampling is performed over the last dimension (trials), but this can
also be done over channels (axis=1).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array</em><em>, </em><em>shape=</em><em>(</em><em>n_times</em><em>, </em><em>n_chans</em><em>[</em><em>, </em><em>n_trials</em><em>]</em><em>)</em>) â Input data.</p></li>
<li><p><strong>n_bootstrap</strong> (<em>int</em>) â Number of bootstrap resamplings (default=2000). For publication
quality results, it is usually recommended to have more than 5000
iterations.</p></li>
<li><p><strong>ci</strong> (<em>length-2 tuple</em>) â Confidence interval (default=(5, 95)).</p></li>
<li><p><strong>axis</strong> (<em>int</em>) â Axis to operate on.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>ci_low, ci_up</strong> â Confidence intervals.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>arrays, shape=(n_times, n_chans)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="meegkit.utils.stats.bootstrap_snr">
<code class="sig-prename descclassname"><span class="pre">meegkit.utils.stats.</span></code><code class="sig-name descname"><span class="pre">bootstrap_snr</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">epochs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_bootstrap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">baseline</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.stats.bootstrap_snr" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Get bootstrap SNR from non-parametric bootstrap resampling.</p>
<p>The lower bound SNR value can serve as a minimum threshold of signal
quality. Parks et al. (2016) suggest using a threshold of 3 dB when
assessing whether to remove subjects from ERP studies.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>epochs</strong> (<em>mne.Epochs instance</em>) â Epochs instance to compute SNR from.</p></li>
<li><p><strong>n_bootstrap</strong> (<em>int</em>) â Number of bootstrap iterations (should be &gt; 10000 for publication
quality).</p></li>
<li><p><strong>baseline</strong> (<em>tuple</em><em> or </em><em>list of length 2</em><em>, or </em><em>None</em>) â The time interval to apply rescaling / baseline correction. If None do
not apply it. If baseline is <code class="docutils literal notranslate"><span class="pre">(bmin,</span> <span class="pre">bmax)</span></code> the interval is between
<code class="docutils literal notranslate"><span class="pre">bmin</span></code> (s) and <code class="docutils literal notranslate"><span class="pre">bmax</span></code> (s). If <code class="docutils literal notranslate"><span class="pre">bmin</span> <span class="pre">is</span> <span class="pre">None</span></code> the beginning of the
data is used and if <code class="docutils literal notranslate"><span class="pre">bmax</span> <span class="pre">is</span> <span class="pre">None</span></code> then <code class="docutils literal notranslate"><span class="pre">bmax</span></code> is set to the end of
the interval. If baseline is <code class="docutils literal notranslate"><span class="pre">(None,</span> <span class="pre">None)</span></code> the entire time interval
is used. If baseline is None, no correction is applied.</p></li>
<li><p><strong>window</strong> (<em>tuple</em><em> or </em><em>list of length 2</em><em>, or </em><em>None</em>) â The time interval used to compute the numerator of the SNR. If window
is <code class="docutils literal notranslate"><span class="pre">(bmin,</span> <span class="pre">bmax)</span></code> the interval is between <code class="docutils literal notranslate"><span class="pre">bmin</span></code> (s) and <code class="docutils literal notranslate"><span class="pre">bmax</span></code>
(s). If <code class="docutils literal notranslate"><span class="pre">bmin</span> <span class="pre">is</span> <span class="pre">None</span></code> the beginning of the data is used and if
<code class="docutils literal notranslate"><span class="pre">bmax</span> <span class="pre">is</span> <span class="pre">None</span></code> then <code class="docutils literal notranslate"><span class="pre">bmax</span></code> is set to the end of the interval. If
window is <code class="docutils literal notranslate"><span class="pre">(None,</span> <span class="pre">None)</span></code> the entire time interval is used. If None
use all positive times.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>ERP</strong> (<em>length-3 tuple</em>) â Mean bootstrap ERP, with 90% confidence intervals.</p></li>
<li><p><strong>SNR</strong> (<em>length-3 tuple</em>) â Mean bootstrap SNR, with 90% confidence intervals.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">References</p>
<p><a class="reference external" href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4751267/">https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4751267/</a></p>
</dd></dl>

<dl class="py function">
<dt id="meegkit.utils.stats.cronbach">
<code class="sig-prename descclassname"><span class="pre">meegkit.utils.stats.</span></code><code class="sig-name descname"><span class="pre">cronbach</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">epochs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">K</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_bootstrap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.stats.cronbach" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Compute reliability of ERP.</p>
<p>Internal reliability of the ERN and Pe as a function of increasing trial
numbers can be quantified with Cronbachâs alpha:</p>
<p>$$alpha = frac{K}{K-1} left(1-frac{sum_{i=1}^K
sigma^2_{Y_i}}{ sigma^2_X}right)$$</p>
<p>Hinton, Brownlow, McMurray, and Cozens (2004) have suggested that
Cronbachâs alpha exceeding .90 indicates excellent internal reliability,
between .70 and .90 indicates high internal reliability, from .50 to .70
indicates moderate internal reliability, and below .50 is low.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>epochs</strong> (<em>mne.Epochs | ndarray</em><em>, </em><em>shape=</em><em>(</em><em>n_trials</em><em>, </em><em>n_chans</em><em>, </em><em>n_samples</em><em>)</em>) â Epochs to compute alpha from.</p></li>
<li><p><strong>K</strong> (<em>int</em>) â Number of trials to use for alpha computation.</p></li>
<li><p><strong>n_bootstrap</strong> (<em>int</em>) â Number of bootstrap resamplings.</p></li>
<li><p><strong>tmin</strong> (<em>float</em>) â Start time of epoch.</p></li>
<li><p><strong>tmax</strong> (<em>float</em>) â End of epoch.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>alpha</strong> (<em>array, shape=(n_chans,)</em>) â Cronbach alpha value</p></li>
<li><p><strong>bounds</strong> (<em>length-2 tuple</em>) â Lower and higher bound of CI.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="meegkit.utils.stats.rms">
<code class="sig-prename descclassname"><span class="pre">meegkit.utils.stats.</span></code><code class="sig-name descname"><span class="pre">rms</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.stats.rms" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Root-mean-square along given axis.</p>
</dd></dl>

<dl class="py function">
<dt id="meegkit.utils.stats.robust_mean">
<code class="sig-prename descclassname"><span class="pre">meegkit.utils.stats.</span></code><code class="sig-name descname"><span class="pre">robust_mean</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">percentile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[5,</span> <span class="pre">95]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.stats.robust_mean" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Do robust mean based on JR Kings implementation.</p>
</dd></dl>

<dl class="py function">
<dt id="meegkit.utils.stats.rolling_corr">
<code class="sig-prename descclassname"><span class="pre">meegkit.utils.stats.</span></code><code class="sig-name descname"><span class="pre">rolling_corr</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.stats.rolling_corr" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Calculate rolling correlation between some data and a reference signal.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array</em><em>, </em><em>shape=</em><em>(</em><em>n_times</em><em>, </em><em>n_chans</em><em>[</em><em>, </em><em>n_epochs</em><em>]</em><em>)</em>) â Test signal. First dimension should be time.</p></li>
<li><p><strong>y</strong> (<em>array</em><em>, </em><em>shape=</em><em>(</em><em>n_times</em><em>[</em><em>, </em><em>n_epochs</em><em>]</em><em>)</em>) â Reference signal.</p></li>
<li><p><strong>window</strong> (<em>int</em>) â Number of timepoints for to include for each correlation calculation.</p></li>
<li><p><strong>fs</strong> (<em>int</em>) â Sampling frequency (default=1).</p></li>
<li><p><strong>step</strong> (<em>int</em>) â If &gt; 1, only compute correlations every <cite>step</cite> samples.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>corr</strong> (<em>array, shape=(n_times - window, n_channels[, n_epochs])</em>) â Rolling window correlation.</p></li>
<li><p><strong>t_corr</strong> (<em>array</em>) â Corresponding time vector.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="meegkit.utils.stats.snr_spectrum">
<code class="sig-prename descclassname"><span class="pre">meegkit.utils.stats.</span></code><code class="sig-name descname"><span class="pre">snr_spectrum</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freqs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_avg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_harm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skipbins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.stats.snr_spectrum" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Compute Signal-to-Noise-corrected spectrum.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>ndarray</em><em> , </em><em>shape=</em><em>(</em><em>n_freqs</em><em>, </em><em>n_chans</em><em>,</em><em>[ </em><em>n_trials</em><em>,</em><em>]</em><em>)</em>) â One-sided power spectral density estimate, specified as a real-valued,
nonnegative array. The power spectral density must be expressed in
linear units, not decibels.</p></li>
<li><p><strong>freqs</strong> (<em>array</em><em>, </em><em>shape=</em><em>(</em><em>n_freqs</em><em>,</em><em>)</em>) â Frequency bins.</p></li>
<li><p><strong>n_avg</strong> (<em>int</em>) â Number of neighbour bins to estimate noise over. Make sure that this
value doesnât overlap with neighbouring target frequencies.</p></li>
<li><p><strong>n_harm</strong> (<em>int</em>) â Compute SNR at each frequency bin as a pooled RMS over this bin and
n_harm harmonics (see references below).</p></li>
<li><p><strong>skipbins</strong> (<em>int</em>) â Number of bins skipped to estimate noise of neighbouring bins.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>SNR</strong> â Signal-to-Noise-corrected spectrum.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray, shape=(n_freqs, n_chans, n_trials) or (n_freqs, n_chans)</p>
</dd>
</dl>
<p class="rubric">References</p>
<dl class="citation">
<dt class="label" id="r5f59cf67c005-1"><span class="brackets">1</span></dt>
<dd><p>Cottereau, B. R., McKee, S. P., Ales, J. M., &amp; Norcia, A. M. (2011).
Disparity-tuned population responses from human visual cortex. The
Journal of Neuroscience, 31(3), 954-965.</p>
</dd>
<dt class="label" id="r5f59cf67c005-2"><span class="brackets">2</span></dt>
<dd><p>Cottereau, B. R., McKee, S. P., &amp; Norcia, A. M. (2014). Dynamics and
cortical distribution of neural responses to 2D and 3D motion in human.
Journal of neurophysiology, 111(3), 533-543.</p>
</dd>
<dt class="label" id="r5f59cf67c005-3"><span class="brackets">3</span></dt>
<dd><p>de Heering, A., &amp; Rossion, B. (2015). Rapid categorization of
natural face images in the infant right hemisphere. Elife, 4.</p>
</dd>
</dl>
</dd></dl>

</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2020, Nicolas Barascud.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.5.1.<br/>
    </p>
  </div>
</footer>
  </body>
</html>